## Oracle PPAS 兼容性分析 之 分区表普通全局索引（NORMAL GLOBAL INDEX）
---

### 一、背景介绍
和分区表一样，分区索引主要提高管理性、可用性、性能、可扩展性。索引可以是分区的独立的 global indexes 或者是分区依赖的 local indexes。通常 global indexes 适用于在OLTP系统中，而 local indexes 适用于OLAP或者DSS 应用。

**分区索引类型选择**
1. 索引 带分布键 => local indexes
2. 唯一索引 & 不包含分区键  => global index
3. 优先级是可管理性  => local indexes
4. 应用是OLTP & 用户需要快速响应   => global index
5. 应用是DSS & 用户更关注于吞吐量   => local index

**分区表索引分类**
+ 普通分区索引
+ 本地分区索引（LOCAL）
+ 全局分区索引 (GLOBAL)

```
CREATE TABLE test (
    id int,
    name varchar2(20),
    age int
)
PARTITION BY RANGE (id) (
    PARTITION p1 VALUES LESS THAN (10),
    PARTITION p2 VALUES LESS THAN (20),
    PARTITION p3 VALUES LESS THAN (maxvalue)
);

-- 1. 普通分区索引
SQL> create index idx_name on test(name);

Index created.

SQL> select index_name,table_name,status from user_indexes where table_name='TEST';

INDEX_NAME                     TABLE_NAME                     STATUS
------------------------------ ------------------------------ --------
IDX_NAME                       TEST                           VALID

SQL> select index_name,table_name,locality from user_part_indexes where table_name='TEST';

SQL>

-- 2. LOCAL分区索引
SQL> create index idx_age on test(age) local;

Index created.

SQL> select index_name,table_name,status from user_indexes where table_name='TEST';

INDEX_NAME                     TABLE_NAME                     STATUS
------------------------------ ------------------------------ --------
IDX_NAME                       TEST                           VALID
IDX_AGE                        TEST                           N/A

SQL> 

SQL> select index_name,table_name,locality from user_part_indexes where table_name='TEST';

INDEX_NAME                     TABLE_NAME                     LOCALI
------------------------------ ------------------------------ ------
IDX_AGE                        TEST                           LOCAL

SQL> 

-- 3. GLOBAL分区索引
CREATE INDEX ig_test_id ON test(id)
GLOBAL PARTITION BY RANGE (id) (
    PARTITION p1 VALUES LESS THAN (5),
    PARTITION p2 VALUES LESS THAN (30),
    PARTITION p3 VALUES LESS THAN (maxvalue)
);

SQL> select index_name,table_name,status from user_indexes where table_name='TEST';

INDEX_NAME                     TABLE_NAME                     STATUS
------------------------------ ------------------------------ --------
IG_TEST_ID                     TEST                           N/A
IDX_NAME                       TEST                           VALID
IDX_AGE                        TEST                           N/A

SQL> 

-- 通过 locality 判断索引是global 或者 local
SQL> select index_name,table_name,locality from user_part_indexes where table_name='TEST';

INDEX_NAME                     TABLE_NAME                     LOCALI
------------------------------ ------------------------------ ------
IG_TEST_ID                     TEST                           GLOBAL
IDX_AGE                        TEST                           LOCAL

SQL> 

```


### 二、转换规则

### 三、参考链接
1.[https://docs.oracle.com/cd/E11882_01/server.112/e25523/partition.htm](https://docs.oracle.com/cd/E11882_01/server.112/e25523/partition.htm)
2.[https://docs.oracle.com/cd/E11882_01/server.112/e25523/part_avail.htm#CIHJCJJF](https://docs.oracle.com/cd/E11882_01/server.112/e25523/part_avail.htm#CIHJCJJF)
